<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Biology Dictionary (Bangla)</title>
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <style>
    /* ‡¶Ü‡¶ó‡ßá‡¶∞ CSS ‡¶Ö‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶ø‡¶§ + Add Word Popup */
    body {margin: 0; font-family: Arial, sans-serif; background: #000; color: #fff; min-height: 100vh; overflow-x: hidden;}
    .title-bar {background: #005f73; color: white; text-align: left; padding: 12px; font-size: 20px; font-weight: bold; display: flex; align-items: center; gap: 10px; position: relative; z-index: 10;}
    .title-bar .icon-home-label {display: flex; align-items: center; gap: 5px; margin-right: 18px;}
    .header {display: flex; align-items: center; background: #111; gap: 8px; padding: 0 12px 0 8px; min-height: 58px; position: relative; z-index: 9;}
    .menu-btn {font-size: 28px; color: #fff; cursor: pointer; background: none; border: none; margin-right: 6px; margin-left: 3px;}
    .search-bar {flex: 1; padding: 10px 12px; background-color: #222; border: none; color: white; border-radius: 6px; font-size: 18px; margin-right: 6px; margin-left: 6px; outline: none; letter-spacing: 0.5px;}
    .icon-btn {background: none; border: none; color: #e0e0e0; font-size: 26px; cursor: pointer; border-radius: 50%; padding: 5px; margin-right: 3px; margin-left: 3px; transition: color 0.2s, background 0.2s;}
    .icon-btn:hover {color: #4fc3f7; background: #222;}
    .sidebar {position: fixed; top: 0; left: -260px; width: 260px; height: 100%; background: #101c28; padding-top: 62px; transition: left 0.3s cubic-bezier(.4,0,.2,1); z-index: 1000; box-shadow: 2px 0 8px rgba(0,0,0,0.2); overflow-y: auto;}
    .sidebar.active {left: 0;}
    .sidebar a {padding: 15px 28px; text-decoration: none; display: flex; align-items: center; color: #fff; border-bottom: 1px solid #1c2635; font-size: 18px; gap: 13px; transition: background 0.2s, color 0.2s; cursor: pointer;}
    .sidebar a:hover, .sidebar a.active {background: #222; color: #4fc3f7;}
    .sidebar-icon {font-size: 23px;}
    .overlay, .history-overlay, .contact-overlay, .addword-overlay {
      position: fixed;
      top: 0; left: 0;
      width: 100vw; height: 100vh;
      background: rgba(0,0,0,0.4);
      display: none;
      z-index: 999;
    }
    .overlay.active, .history-overlay.active, .contact-overlay.active, .addword-overlay.active {display: block;}
    .main {padding: 18px 6px 50px 6px; margin-top: 5px; max-width: 650px; margin-left: auto; margin-right: auto;}
    .definition {background: #222; padding: 15px; border-radius: 8px; margin-top: 20px;}
    .definition h2 {margin-top: 0; color: #4fc3f7;}
    .definition .breakdown {margin: 8px 0; color: #ffd166;}
    .definition .meaning {margin: 6px 0; color: #fff;}
    .definition .example {color: #aaa; font-style: italic; margin-top: 10px;}
    .not-found {color: red; margin-top: 22px; font-size: 18px;}
    .suggestions {margin-top: 10px; background: #1a1a1a; border-radius: 5px; padding: 10px;}
    .suggestion-item {padding: 8px 12px; cursor: pointer; border-bottom: 1px solid #333; font-size: 17px; color: #fff;}
    .suggestion-item:hover {background: #333; color: #4fc3f7;}
    #quizPanel {background: #1a1a1a; padding: 18px; border-radius: 10px; margin-top: 18px; position: relative;}
    #quizPanel h2 {color: #4fc3f7;}
    #nextQuizBtn {margin-top: 16px; background: #005f73; color: #fff; border: none; padding: 9px 16px; border-radius: 7px; cursor: pointer; font-size: 16px;}
    .quiz-opt-btn {margin: 7px 0; padding: 7px 11px; border-radius: 5px; background: #222; color: #fff; border: 1px solid #444; cursor: pointer; font-size: 16px; width: 100%; text-align: left; transition: background 0.2s, color 0.2s;}
    .quiz-opt-btn:hover:enabled {background: #333; color: #4fc3f7;}
    .close-btn {position: absolute; top: 10px; right: 16px; background: #333; color: #fff; border: none; border-radius: 50%; width: 32px; height: 32px; cursor: pointer; font-size: 20px;}
    .close-btn:hover {background: #c62828;}
    /* Add Word Popup */
    #addWordPopup {
      position: fixed;
      top: 50%; left: 50%;
      transform: translate(-50%, -50%);
      background: #222;
      color: #fff;
      border-radius: 13px;
      box-shadow: 0 8px 40px #0006;
      width: 95vw;
      max-width: 350px;
      z-index: 2200;
      padding: 0;
      display: none;
      flex-direction: column;
      overflow: hidden;
    }
    #addWordPopup.active {display: flex;}
    #addWordPopupHeader {
      padding: 14px 18px 10px 24px;
      background: #005f73;
      font-size: 19px;
      font-weight: bold;
      display: flex;
      align-items: center;
      justify-content: space-between;
      border-top-left-radius: 12px;
      border-top-right-radius: 12px;
    }
    #addWordPopupBody {
      flex: 1;
      padding: 18px 19px 18px 19px;
      background: #222;
      display: flex;
      flex-direction: column;
      gap: 12px;
      align-items: stretch;
    }
    #addWordForm label {font-size:16px; margin-bottom:4px;}
    #addWordForm input, #addWordForm textarea {
      width: 100%; border-radius: 6px; border: 1px solid #444; background: #101c28; color: #fff; padding: 7px; font-size: 15px; margin-bottom: 7px;
    }
    #addWordForm textarea {resize: vertical;}
    #addWordFormBtns {
      display: flex; gap: 9px; margin-top: 6px; justify-content: flex-end;
    }
    #addWordFormBtns button {
      padding: 8px 18px;
      border-radius: 6px;
      border: none;
      font-size: 15px;
      cursor: pointer;
      background: #005f73;
      color: #fff;
      transition: background 0.2s;
    }
    #addWordFormBtns button.cancel {background: #333;}
    #addWordFormBtns button.cancel:hover {background:#c62828;}
    #addWordFormBtns button.submit:hover {background:#207490;}
    .success-msg {color: #38c172; margin-bottom:8px;}
    .error-msg {color: #c62828; margin-bottom:8px;}
    @media (max-width:600px) {
      #addWordPopup {max-width: 98vw;}
    }
  </style>
</head>
<body>
  <div class="title-bar">
    <span class="icon-home-label">
      <span class="material-icons" style="font-size:28px;">home</span>
      <span>Home</span>
    </span>
    <span class="icon">üî¨</span>
    <span>Biology Dictionary (Bangla)</span>
  </div>
  <div class="header">
    <button class="menu-btn material-icons" id="menuBtn" type="button">menu</button>
    <span class="lang-toggle">E&gt;B</span>
    <input type="text" id="searchInput" class="search-bar" placeholder="'EN'/'BN' text here." onkeyup="showSuggestions()">
    <button class="icon-btn material-icons" onclick="searchWord()">search</button>
    <button class="icon-btn material-icons" id="quizIconBtn" title="Quiz">quiz</button>
    <button class="icon-btn material-icons" onclick="showHistoryPopup()" title="History">history</button>
  </div>
  <div class="sidebar" id="sidebar">
    <a href="#" onclick="showMain(); return false;" id="sideHome"><span class="sidebar-icon material-icons">home</span>Home</a>
    <a href="#" onclick="showBookmarks(); return false;" id="sideBookmark"><span class="sidebar-icon material-icons">bookmark</span>Bookmark</a>
    <a href="#" onclick="showHistoryPopup(); return false;" id="sideHistory"><span class="sidebar-icon material-icons">history</span>History</a>
    <a href="#" onclick="showQuizModePopup(); return false;" id="sideQuiz"><span class="sidebar-icon material-icons">quiz</span>Quiz</a>
    <a href="#" onclick="showAddWordPopup(); return false;" id="sideAddWord"><span class="sidebar-icon material-icons">add_circle</span>Add or Edit Words</a>
    <a href="#" onclick="showContactPopup(); return false;" id="sideContact"><span class="sidebar-icon material-icons">contact_mail</span>Contact</a>
    <!-- ...rest unchanged... -->
  </div>
  <div class="overlay" id="overlay"></div>
  <div class="addword-overlay" id="addWordOverlay"></div>
  <!-- Add Word Popup -->
  <div id="addWordPopup">
    <div id="addWordPopupHeader">
      Add new word
      <button class="popup-close-btn" id="closeAddWordPopupBtn" title="Close">&times;</button>
    </div>
    <div id="addWordPopupBody">
      <form id="addWordForm">
        <div class="success-msg" id="addWordSuccessMsg" style="display:none;"></div>
        <div class="error-msg" id="addWordErrorMsg" style="display:none;"></div>
        <label for="addWord">Word</label>
        <input type="text" id="addWord" name="word" required>
        <label for="addMeaning">Meaning</label>
        <textarea id="addMeaning" name="meaning" rows="2" required></textarea>
        <label for="addBreakdown">Breakdown</label>
        <input type="text" id="addBreakdown" name="breakdown">
        <label for="addExample">Example</label>
        <textarea id="addExample" name="example" rows="2"></textarea>
        <div id="addWordFormBtns">
          <button type="button" class="cancel" id="addWordCancelBtn">Cancel</button>
          <button type="submit" class="submit">Submit</button>
        </div>
      </form>
    </div>
  </div>
  <!-- ‡¶¨‡¶æ‡¶ï‡ßÄ Popup/Panel ‡¶ó‡ßÅ‡¶≤‡ßã unchanged (historyPanelPopup, contactPopup, quizPanel etc.) -->
  <div class="main" id="mainContent">
    <div id="suggestionBox" class="suggestions"></div>
    <div id="resultArea"></div>
    <div id="quizPanel" style="display:none;">
      <button class="close-btn" id="closeQuizBtn" title="Close">&times;</button>
      <h2>Quiz Panel</h2>
      <div id="quizQuestion"></div>
      <div id="quizOptions"></div>
      <div id="quizFeedback" style="margin-top:10px; font-size:17px;"></div>
      <button id="nextQuizBtn" style="display:none;">Next</button>
    </div>
  </div>
  <!-- ‡¶°‡¶ø‡¶ï‡¶∂‡¶®‡¶æ‡¶∞‡¶ø JS ‡¶∏‡¶†‡¶ø‡¶ï‡¶≠‡¶æ‡¶¨‡ßá ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡ßÅ‡¶® -->
  <script src="dictionary.js"></script>
  <script>
    // ----- Sidebar & Overlay -----
    const sidebar = document.getElementById('sidebar');
    const overlay = document.getElementById('overlay');
    const menuBtn = document.getElementById('menuBtn');
    menuBtn.onclick = function() {
      sidebar.classList.add('active');
      overlay.classList.add('active');
    };
    overlay.onclick = function() {
      sidebar.classList.remove('active');
      overlay.classList.remove('active');
    };
    document.querySelectorAll('#sidebar a').forEach(function(a){
      a.addEventListener('click', function(){
        sidebar.classList.remove('active');
        overlay.classList.remove('active');
      });
    });
    // ----- Dictionary Data -----
    let localWords = JSON.parse(localStorage.getItem('localWords') || "[]");
    let bookmarks = JSON.parse(localStorage.getItem('bookmarks') || "[]");
    let history = JSON.parse(localStorage.getItem('history') || "[]");
    let serverWords = [];

    // dictionary.js ‡¶•‡ßá‡¶ï‡ßá dictionary variable ‡¶≤‡ßã‡¶° ‡¶π‡¶¨‡ßá‡•§
    function getCombinedDictionary() {
      let dictArr = [];
      if (window.dictionary && Array.isArray(window.dictionary)) dictArr = window.dictionary;
      return [...dictArr, ...localWords, ...serverWords];
    }

    function setSidebarActive(id) {
      ["sideHome", "sideBookmark", "sideHistory", "sideQuiz", "sideAddWord"].forEach(i => {
        let el = document.getElementById(i);
        if (el) el.classList.remove("active");
      });
      if (id) {
        let el = document.getElementById(id);
        if (el) el.classList.add("active");
      }
    }

    function closeAllPanels() {
      document.getElementById("resultArea").style.display = "none";
      document.getElementById("suggestionBox").style.display = "none";
      document.getElementById("quizPanel").style.display = "none";
    }

    function showMain() {
      setSidebarActive("sideHome");
      closeAllPanels();
      document.getElementById("resultArea").style.display = "block";
      document.getElementById("suggestionBox").style.display = "block";
    }

    function showBookmarks() {
      setSidebarActive("sideBookmark");
      closeAllPanels();
      document.getElementById("resultArea").style.display = "block";
      document.getElementById("resultArea").innerHTML = "<b>Bookmarks:</b><br>" + (bookmarks.length ? bookmarks.map(w => `<div>${w.word}</div>`).join("") : "No bookmarks yet.");
    }

    // --- Search & Suggestion ---
    function searchWord() {
      closeAllPanels();
      setSidebarActive("sideHome");
      document.getElementById("resultArea").style.display = "block";
      document.getElementById("suggestionBox").style.display = "block";
      const input = document.getElementById("searchInput").value.trim().toLowerCase();
      document.getElementById("resultArea").innerHTML = "";
      document.getElementById("suggestionBox").innerHTML = "";
      let allDict = getCombinedDictionary();
      let result = allDict.find(entry => entry.word && entry.word.toLowerCase() === input);
      if (result) {
        displayResult(result);
        addToHistory(result);
      } else {
        document.getElementById("resultArea").innerHTML = `<p class="not-found">‚ùå Sorry, word not found.</p>`;
      }
    }
    function showSuggestions() {
      const input = document.getElementById("searchInput").value.trim().toLowerCase();
      document.getElementById("suggestionBox").innerHTML = "";
      if (input.length === 0) return;
      let allDict = getCombinedDictionary();
      const matches = allDict.filter(entry => entry.word && entry.word.toLowerCase().startsWith(input)).slice(0, 5);
      matches.forEach(entry => {
        const item = document.createElement("div");
        item.className = "suggestion-item";
        item.textContent = entry.word;
        item.onclick = () => {
          document.getElementById("searchInput").value = entry.word;
          document.getElementById("suggestionBox").innerHTML = "";
          searchWord();
        };
        document.getElementById("suggestionBox").appendChild(item);
      });
    }

    function displayResult(result) {
      document.getElementById("resultArea").innerHTML = `
        <div class="definition">
          <h2>${result.word}</h2>
          <div class="breakdown"><b>‡¶ó‡¶†‡¶®:</b> ${result.breakdown ? result.breakdown : "‚Äî"}</div>
          <div class="meaning"><b>‡¶Ö‡¶∞‡ßç‡¶•:</b> ${result.meaning ? result.meaning : "‚Äî"}</div>
          <div class="example"><b>‡¶â‡¶¶‡¶æ‡¶π‡¶∞‡¶£:</b> ${result.example ? result.example : "‚Äî"}</div>
        </div>
      `;
    }
    function addToHistory(wordObj) {
      if (!history.find(item => item.word === wordObj.word)) {
        history.unshift({ word: wordObj.word, time: new Date().toLocaleString() });
        if (history.length > 50) history.pop();
        localStorage.setItem('history', JSON.stringify(history));
      }
    }
    window.onload = showMain;

    // ---- Add Word Popup ----
    const addWordPopup = document.getElementById("addWordPopup");
    const addWordOverlay = document.getElementById("addWordOverlay");
    const addWordForm = document.getElementById("addWordForm");
    const addWordSuccessMsg = document.getElementById("addWordSuccessMsg");
    const addWordErrorMsg = document.getElementById("addWordErrorMsg");
    function showAddWordPopup() {
      setSidebarActive("sideAddWord");
      addWordPopup.classList.add("active");
      addWordOverlay.classList.add("active");
      document.body.style.overflow = "hidden";
      addWordForm.reset();
      addWordSuccessMsg.style.display = "none";
      addWordErrorMsg.style.display = "none";
    }
    function closeAddWordPopup() {
      addWordPopup.classList.remove("active");
      addWordOverlay.classList.remove("active");
      document.body.style.overflow = "";
    }
    document.getElementById("closeAddWordPopupBtn").onclick = closeAddWordPopup;
    document.getElementById("addWordCancelBtn").onclick = closeAddWordPopup;
    addWordOverlay.onclick = closeAddWordPopup;

    addWordForm.onsubmit = function(e) {
      e.preventDefault();
      addWordSuccessMsg.style.display = "none";
      addWordErrorMsg.style.display = "none";
      const word = addWordForm.word.value.trim();
      const meaning = addWordForm.meaning.value.trim();
      const breakdown = addWordForm.breakdown.value.trim();
      const example = addWordForm.example.value.trim();
      if (!word || !meaning) {
        addWordErrorMsg.textContent = "Word ‡¶è‡¶¨‡¶Ç Meaning ‡¶¶‡¶ø‡¶§‡ßá ‡¶π‡¶¨‡ßá!";
        addWordErrorMsg.style.display = "block";
        return;
      }
      fetch("https://parseapi.back4app.com/classes/Words", {
        method: "POST",
        headers: {
          "X-Parse-Application-Id": "ajoJF5djJIbi5BgETu5XMYh48GTayCJx2uQi3dzO",
          "X-Parse-REST-API-Key": "Tfh8T9FEImgQbVJmkeTLFbRYIWcjyyEcrDxq09dS",
          "Content-Type": "application/json"
        },
        body: JSON.stringify({word, meaning, breakdown, example})
      })
      .then(res => {
        if(res.ok) return res.json();
        throw new Error("Network Error");
      })
      .then(data => {
        addWordSuccessMsg.textContent = "Success! ‡¶∂‡¶¨‡ßç‡¶¶‡¶ü‡¶ø ‡¶Ø‡ßÅ‡¶ï‡ßç‡¶§ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡•§";
        addWordSuccessMsg.style.display = "block";
        addWordForm.reset();
        // ‡¶®‡¶§‡ßÅ‡¶® ‡¶∂‡¶¨‡ßç‡¶¶ server ‡¶•‡ßá‡¶ï‡ßá ‡¶∞‡¶ø‡¶´‡ßç‡¶∞‡ßá‡¶∂ ‡¶ï‡¶∞‡ßÅ‡¶®
        loadDictionaryFromServer();
      })
      .catch(err => {
        addWordErrorMsg.textContent = "Error: ‡¶∂‡¶¨‡ßç‡¶¶‡¶ü‡¶ø ‡¶Ø‡ßÅ‡¶ï‡ßç‡¶§ ‡¶ï‡¶∞‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º‡¶®‡¶ø!";
        addWordErrorMsg.style.display = "block";
      });
    };

    // ---- Load serverWords on page load ----
    function loadDictionaryFromServer() {
      fetch('https://parseapi.back4app.com/classes/Words', {
        headers: {
          'X-Parse-Application-Id': 'ajoJF5djJIbi5BgETu5XMYh48GTayCJx2uQi3dzO',
          'X-Parse-REST-API-Key': 'Tfh8T9FEImgQbVJmkeTLFbRYIWcjyyEcrDxq09dS',
        },
      })
      .then(response => response.json())
      .then(data => {
        if (data.results) {
          serverWords = data.results;
        }
      })
      .catch(error => {});
    }
    loadDictionaryFromServer();
    // --- Rest of JS unchanged (quiz, contact, history etc.) ---
  </script>
</body>
                          </html>
